<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VIO VIDEOS - Player dengan Iklan</title>
<style>
body {margin:0; font-family: Arial,sans-serif; background:#111; color:#fff;}
header {background:#222; padding:15px; text-align:center;}
header span {color:red;}
.player-container {max-width:800px; margin:20px auto; position:relative; background:#000; border-radius:10px; overflow:hidden;}
video {width:100%; display:block;}
#adContainer {position:absolute; top:0; left:0; width:100%; height:100%; background:#000; display:none; z-index:100;}
.ad-countdown, .skip-ad {position:absolute; background:rgba(0,0,0,0.7); color:#fff; padding:5px 10px; border-radius:20px; display:none; z-index:101;}
.ad-countdown {top:15px; right:15px;}
.skip-ad {bottom:15px; right:15px; cursor:pointer;}
#videoTitle {padding:10px; text-align:center; font-size:1.2rem;}
.playlist {max-width:800px; margin:20px auto; background:#222; border-radius:10px; padding:10px;}
#playlist li {padding:10px; cursor:pointer; border-bottom:1px solid #444;}
#playlist li.playing {background:red; font-weight:bold;}
</style>
</head>
<body>

<header><h1><span>â–¶</span> VIO VIDEOS</h1></header>

<main class="container">
  <div class="player-container">
    <video id="mainVideo" controls></video>
    <div id="adContainer"></div>
    <div class="ad-countdown" id="adCountdown">Iklan: 15 detik</div>
    <div class="skip-ad" id="skipAd">Lewati Iklan</div>
    <h3 id="videoTitle">Pilih video dari playlist</h3>
  </div>

  <!-- Playlist -->
  <aside class="playlist">
    <h3>Daftar Putar</h3>
    <ul id="playlist">
      <li data-video="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4">Video 1: Big Buck Bunny</li>
      <li data-video="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4">Video 2: Elephants Dream</li>
      <li data-video="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4">Video 3: For Bigger Blazes</li>
      <li data-video="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerEscapes.mp4">Video 4: For Bigger Escapes</li>
      <li data-video="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerFun.mp4">Video 5: For Bigger Fun</li>
    </ul>
  </aside>
</main>

<script>
const videoPlayer = document.getElementById('mainVideo');
const adContainer = document.getElementById('adContainer');
const adCountdown = document.getElementById('adCountdown');
const skipAd = document.getElementById('skipAd');
const videoTitle = document.getElementById('videoTitle');
const playlistEl = document.getElementById('playlist');

let adPlaying = false;
let adDuration = 15; 
let midRollTime = 10; 
let postRollTime = null;

// Load playlist video
playlistEl.querySelectorAll('li').forEach(li=>{
  li.addEventListener('click', ()=>{
    playlistEl.querySelectorAll('li').forEach(x=>x.classList.remove('playing'));
    li.classList.add('playing');
    playAd(li.dataset.video, li.textContent, 'pre-roll');
  });
});

// Fungsi load iklan
function loadExoClickAd() {
  adContainer.innerHTML = '';
  const iframe = document.createElement('iframe');
  iframe.src = 'https://s.magsrv.com/v1/vast.php?idzone=5720036';
  iframe.width='100%'; iframe.height='100%'; iframe.frameBorder='0'; iframe.allowFullscreen=true;
  adContainer.appendChild(iframe);
}

// Fungsi play iklan
function playAd(videoUrl, title, type='pre-roll'){
  adPlaying=true;
  videoPlayer.style.display='none'; // sembunyikan video utama
  adContainer.style.display='block';
  adCountdown.style.display='block';
  skipAd.style.display=(type!=='post-roll')?'block':'none';
  loadExoClickAd();

  let timeLeft=adDuration;
  adCountdown.textContent=`Iklan: ${timeLeft} detik`;
  const timer=setInterval(()=>{
    timeLeft--;
    adCountdown.textContent=`Iklan: ${timeLeft} detik`;
    if(timeLeft<=0) finishAd();
  },1000);

  skipAd.onclick = (type!=='post-roll')? finishAd : null;

  function finishAd(){
    clearInterval(timer);
    adPlaying=false;
    adContainer.style.display='none';
    adCountdown.style.display='none';
    skipAd.style.display='none';
    videoPlayer.style.display='block';
    videoPlayer.src = videoUrl;
    videoTitle.textContent = title;
    videoPlayer.load();
    videoPlayer.play().catch(()=>{});
    videoPlayer.midAdPlayed=false;
    videoPlayer.postAdPlayed=false;
  }
}

// Mid-roll & Post-roll
videoPlayer.addEventListener('timeupdate', ()=>{
  if(adPlaying) return;
  const t=Math.floor(videoPlayer.currentTime);
  if(t===midRollTime && !videoPlayer.midAdPlayed){
    videoPlayer.midAdPlayed=true;
    playAd(videoPlayer.src, videoTitle.textContent,'mid-roll');
  }
  if(postRollTime && t===postRollTime && !videoPlayer.postAdPlayed){
    videoPlayer.postAdPlayed=true;
    playAd(videoPlayer.src, videoTitle.textContent,'post-roll');
  }
});

// Set post-roll saat video dimuat
videoPlayer.addEventListener('loadedmetadata', ()=>{
  postRollTime = Math.floor(videoPlayer.duration) - 15;
});
</script>

</body>
</html>
